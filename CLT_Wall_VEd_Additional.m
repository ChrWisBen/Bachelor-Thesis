function [Y,Xf,Af] = CLT_Wall_VEd_Additional(X,~,~)
%CLT_WALL_VED_ADDITIONAL neural network simulation function.
%
% Auto-generated by MATLAB, 22-Nov-2025 14:48:24.
% 
% [Y] = CLT_Wall_VEd_Additional(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 18xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;0;0;0;0;3.72019e-05;1.63045e-06;1.2496e-06;1.05432e-06;5.26247e-08;1.00989e-06;4.90043e-06;8.40567e-06;1.10127e-06;2.08222e-06;2.42122e-06;7.4904e-07;4.34717e-06];
x1_step1.gain = [2.00000819003354;2.03261699638497;2.05691675638655;2.00002190023981;2.47251188924959;2.00007654472944;2.00001614503033;2.00001780535851;2.00000359264645;2.00000562326521;2.00000297178442;2.0000160809893;2.00001761349512;2.00000344454593;2.00000610845866;2.0000082704742;2.00000251208316;2.0000091323817];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.089215874962927446679;-1.2580984691555310295;6.0241895652561430197;-1.1100627094850348264;10.862816757463123807;3.058517686631673449;-0.090842348982244983113;-0.47093291893681205051;-9.8170859269257615409;4.5592792800815979959;2.5777781851047611994;8.8609013022036275942;0.48868888586751690895;0.40014333997133783027;0.5273812560890083212;-8.3035179010144055667];
IW1_1 = [0.039437245514905440447 -0.17132159683372774617 -0.022333976804075152123 0.33633889067850919474 1.6050376390178930919 -0.84305929730140627409 0.017291846339035632507 0.0042907270706598827151 -0.0010839932326583876735 -0.0043779620546813471232 0.0016622853906280809881 -0.29493236674168571421 -0.019929610165563590995 0.0018438485744207021213 0.0040010567013359270641 0.0028672286417157151657 -0.048248641984843958219 0.003635601111709071704;-0.10778309718891582181 -0.17201656249796143383 0.0030954408198483646282 0.53181878685143135765 0.28834034803935654212 0.69298050590398696524 0.43074772372462172276 0.0013684703869626211204 -0.0053286344279730637336 -0.0051527302781332780246 0.007070995788442920385 0.27689959976886491244 -0.048085721472741801974 -0.028218082866655901791 -0.004864813042034810478 -0.0048884201780459808281 0.46313035135887598015 -0.0021116367624993046502;0.0073635383541921610451 -0.081305351544387755025 -0.055043254037416951274 -0.036629858092734585151 -1.39617480783414738 -0.39111596670123038866 5.3402530818993501072 0.0011498101387681443526 0.00051563301307872184964 0.0041088243580101489402 -0.0028468768023797875327 -0.0016826956523805815247 -0.049801687849644789285 0.0030069742600122672908 -0.016723534958509887749 0.00094514129795268382941 -0.070895527626571197555 0.0067621010376981635637;-0.24320336490476390789 3.6010944289107724714 0.10770269010250571595 0.49222466293830474671 0.048680941928199480961 0.15573408163386209813 -0.13638537119743132653 -0.0145363283652053428 0.31327106387822167832 -0.0083606536566203561861 0.0070276784743782310175 -0.64272292371623984675 0.2262699147414700962 -0.011839467647267424774 -0.93863292796276309726 0.002761036872650558284 0.10999727532406321229 -0.027750155122469741253;0.027835593365859598314 0.97505311103919822813 0.098032919617291172654 -0.51649064223233520643 0.33141539636562478144 -0.5367438249597883404 15.161633322877891672 0.004687698288215855387 -0.01121780067359541555 -0.023154548660295880963 0.0075480347219498335892 0.025148661643025909534 -0.053518366740650469282 -0.020444038967133090073 -0.021494477053182803328 -0.010289694610424355431 0.14724898276009498743 -0.026486544998094749964;-0.061620239381142985491 0.12188382753923997226 0.023771200158519498885 -0.74842248737615502119 0.38859512918549926619 6.2477413927226432833 -0.21042217856325873271 -0.013001077752503123822 -0.024743096779304231403 0.0019880676648626233356 0.0042646551623116042695 -0.040492482706930260639 0.011878720355355238888 0.013794650954545580046 0.028225921449926912737 0.048881987103278824736 -0.075607998400307116493 -0.010445494179944057531;0.075043362719093134605 0.095231888969592060068 -0.012137018343661643699 -0.67861889721399626385 0.27327793998711891188 -0.37855840900828324758 -0.28073024332898743882 0.00083589900490766712825 0.0051441471291884610997 0.00092438640571697230225 -0.0047974427477208009263 -0.1070122889826345125 0.024407208473047867919 0.011821856536066283755 -0.0066882314413624337907 0.0042312530086153817693 0.83820590136239025991 0.0029918485495948072411;-0.033804510761741263236 -0.10665226591983185955 0.066323102600269509543 0.14798997083756415538 1.3957118572133304646 -1.3216668750783728825 0.16626252769321611669 -0.0019040005276630630766 0.0013688501817422414966 0.003273165061108682973 0.00041283567302349442538 0.10190085779210845962 -0.021893374544785230984 0.0016445840449425578548 -0.0041829803118045129698 0.00023024792692310711018 0.23526585026306520709 -0.0022279786909833246278;0.037226541289945326574 2.2176833268117017717 0.25632544990919803318 -0.28783138730372975767 0.77701191478373832222 22.819170328178149276 -0.097102607146218405942 0.028335541108996022824 -0.0037075225756111264593 0.00091889797422282557503 0.013737890751581795928 -0.065855820150658675449 -0.071691978933405342556 -0.0092484450363712646104 -0.03779547598474780612 0.031834597056224496481 0.01232996705850399749 -0.012335807325219281042;-0.016281636528378655437 5.5900816470896304011 -0.10293450999260690681 0.44620370634679262789 0.42143400938444142145 0.73773330786948498883 0.423855699338273606 0.0033267639552354306282 -0.0038683698168982564788 -0.0030462476947772901444 0.0047869869709056579732 0.17509637205490174994 -0.05643243289766707721 -0.026002149267890142803 -0.008779721622004922274 0.0028848575508045922605 -0.01423303474694270071 -0.0019433494655508927896;-0.0040274071583815173117 1.6916157709710761825 0.09550306298123957538 1.0196431850718512546 0.51450910952478967619 -0.5045675113042746851 -0.22813675824622328681 0.0063913226906486750312 -0.0076112491067734126468 -0.0021626530915949512997 -0.0024093715645788372354 0.041008212825539049062 -0.00059620681731897416829 0.0084155103704066543113 0.015677246678125734969 -0.0037680141873399210055 -0.054365726175389053609 0.00036439077989147466898;0.046397418048386721012 8.6636944580121610926 0.027675056638554018651 -0.58626161660710252033 -0.39447822071477978145 -0.35062680579603150433 -0.34514681299505672873 -0.0021151737139970604 0.0029503865941512196977 -0.00050869636540598357072 -0.0022342227144908793392 -0.11890976922882601219 0.054827058368492657958 0.017698749342685504704 0.0091233756975825051894 -0.0042473032389548619897 0.36334357527395705345 0.0022505974179605901971;-0.00730427178071102641 1.0783733372236057324 0.052181603551049907108 -0.29330647884968058525 0.3506455035012620014 -0.14049907769874486752 -0.30156331812940734283 -0.0039731391607463403814 -0.00074966717695322104137 -0.00036817590427257239436 -0.0012858865331867772551 0.13650649558511171455 0.065284748680034740409 0.014140253806030064071 0.019361542330440691118 -0.012039610522936110282 -0.21484835841322097449 0.00032879985779483869406;-0.0085156056885590421246 0.22462108937523997398 0.18023922634384795249 -0.041348942017759848788 -0.57588891063928004943 0.75354337200718046752 0.42513809701511118266 -0.0078385131681218984251 0.0041606680983121190412 0.0051778561772625021978 -0.00028673705303851603236 -0.039793347156776424922 -0.051838002436080110602 -0.022061245595994382479 -0.034433962647467612761 0.0034162340058571018936 0.49789151383441465626 -0.002000522055531546179;-0.020379980445949717055 -1.009182034150993168 -0.044334270564969878448 -0.40439628645782943472 -0.83665033411419875709 -1.7321533244478359848 0.25086220344229992474 -0.003774400939707980504 0.017165878263011712102 0.0073821228080102113331 -0.0064332212285266440407 0.10783214639638682986 -0.045335402385617923349 0.014708262742986288538 -0.030860565543740312716 0.02281125825714494515 -0.036412532906474205652 -0.00095807575698017349505;-0.035714451020714861607 0.51436747523208969923 0.040627133984507117492 0.077775480149871512037 1.2462275988318283204 -0.46990272820209233462 -0.1735728961822299854 0.0071216034373552655062 -0.005325850855051069907 -0.036997439158857906016 0.001541364673218696647 0.22025942126819827993 0.01134938424768538838 -0.0063410570296401026422 -0.045140671817947265743 0.013237935163915536679 -7.5307201080949353056 -0.005373708702020732822];

% Layer 2
b2 = [-1.0024325081370784041;3.3827913345241267251;-4.0315263724978533943;3.7639876258270339449;-0.76577879254218872429;0.6516423405859329554;7.3831838331789558794;3.3230922138008396338;8.2885935154272019076;2.0952033930531692718;-0.78942335073411207258;-3.7834745010467503157;1.0619217754223184702;0.23377107801916741092;3.0922532157105924178;3.9901286237697286552];
LW2_1 = [0.70253208094626540259 0.32917428371390294872 -4.7618815058007832874 -0.23274725765953130363 0.91293612322547279536 2.9273654153094561536 2.0842778084118078752 4.2039745897211853176 0.14727863863975351744 -0.030436742275328974167 1.784968187492857572 -0.61284517268886795627 1.4316812227589381656 -4.2268080042289692955 -0.34094731945714079613 -1.529770229418279559;-1.0815821191184331607 -1.6850894141938037585 0.773998170309967648 -0.50049798148714119694 -1.6431512601143343222 -1.4985850689053643592 4.9462048030383334307 0.41748055953573770527 -0.85412686623359523885 2.363411518880252693 -0.68671626747842440253 0.67821556824971418465 4.3458715517669039841 0.52598128539143362836 -4.068609722106024229 -1.2608320993355039974;3.1746915023237378684 -0.98627518510873857238 -0.61451890390420449428 0.016171568591659829517 0.44370626913402355651 -1.4520490986304195324 0.30149380605305325931 7.1215235482862384586 -0.02576291135300657828 -0.94847533393834393411 -0.41272922827360714049 1.402187269035598316 3.4868329256025005769 -1.2965608241138710799 0.21997231515946830127 -0.77359197522946976378;-3.7956020352932795525 0.80001849541683400791 -0.62314434939277985048 0.96784667907972921075 -0.082840496366174756759 -2.4866110257537465955 -0.51172693033075711266 2.9464627399596703405 0.1699404775092996922 0.97294351127636280463 3.5203847421741985002 -1.6692909979329155767 -3.0490031337344070117 -2.6012065367832453155 4.0796156096316336104 0.42516897202224446239;-1.6824544186959109471 2.6037050549077016548 0.83924783690945614634 0.60704377035218004544 -1.9473076435847094245 0.052336024441702148902 0.90542569882532253356 0.82184558858493528266 -0.44986684431887924429 1.2385589630748174983 -1.2287519421496835292 1.8610675133076535204 -0.70754205761671939978 2.0028249627844765257 -0.010238754112941853003 -4.5541388252920063096;-4.5116229371922171865 2.1921980605126374364 -2.1325102971830145471 0.30125965113146629948 0.76971490833006961374 -1.2548058382119722243 -1.504139440304280928 3.2415538724703574225 -2.9106468118702797376 -2.0198675286436973408 1.0940013580149769989 4.0554183171725437518 -6.5413910401550632301 -3.0961156408525827288 2.6654064672818553738 -1.2269174989790683217;1.6480849704020463786 2.9901609006993044027 0.33217458983455144805 -0.46978139776819904938 -1.2160807902713430817 0.82540532674038935568 1.8546669822600119204 -1.2241831514435526085 -0.017179355452184751768 -7.7760456528925878672 -2.5655866625156833472 -8.15647602753037404 0.16399346815637866337 -0.905632501265815959 -0.38351757165161376451 -3.6984704091773852319;-2.6733977800959078941 2.1081165592140012066 -0.33809727976805470373 -0.61106733740379903796 -1.4389581038040639704 0.54679752174702878076 2.3832479808104434227 -1.1666512723814970176 -3.3143128351303223766 -2.8423801303502331805 2.9846340235754595938 2.542031465055360151 -0.98692615396090677127 -0.30813225733956339791 -0.24654408626049273412 1.4197720211686104541;-0.082900107655150920283 -0.60660814619253067281 -0.93755019632413671982 0.82824778410273569573 -3.0697952439524791579 -6.0394143877649373309 -0.34819839450743328424 -0.94491441591316105431 -0.7676851868700619308 -0.8506032631151591028 0.53878579056035580397 -1.3085387121662217513 0.68624671792187763586 1.048998287903727622 1.598691972346248491 -1.7772837685496740701;0.16959093889875001548 -2.1913957012284921433 -2.5430195029297193443 1.0951989181019028408 -0.61674975089489147972 2.5886058521948021038 3.0115812168356921319 1.2962985989939650455 1.4247312335490609492 -0.40015554259951574556 -0.11229449933247084847 -0.062713343048570791005 0.69406173954526095837 -2.7717954726231912588 -2.6257456850899121292 0.23685846745235733524;2.7008324726470491761 -1.5789174997827337688 -1.1566106164178393545 -0.088668572167872369838 -0.1465712613509498885 -1.0410545134686144397 3.2109925809352954928 1.540665449094840378 0.0097787417549449785759 4.3803877608686718759 -0.68195022761363699448 -1.9841154105136162844 4.5648678172744814319 1.0593976070337784989 0.83823479031242897896 -1.2965668654049926634;-1.9553874952688981015 1.3889985751455184992 3.4498223194653165891 -0.0072399652637744685291 0.77556713399887422522 -0.40693765345281357471 0.20032993639129820229 -3.3931416497337063554 -0.52345637696390612259 -1.0658481284402583356 0.14840106665954444498 1.6937195029746952013 0.97750796946639895157 0.56839500429714484575 -0.74262624157715217965 -1.5426550750037419935;1.7358310894679089831 -1.3238133428977747474 0.061366543054735864238 5.4717468288973760693 -0.15218547040534805004 -0.42769129948623058057 -0.63153454037244427521 2.6817233850121975358 0.65411665641524541215 -1.2392883343753975378 6.3258222605896543556 -5.9314846967598020555 -2.521686576191261242 -1.4567970419723981212 2.8600578221806367551 0.18318570602237602141;-0.098257993632441670284 1.499790309079553019 0.72387071442506145669 -1.7835730145373387412 3.5613976334797206036 -1.2372205122378647779 2.6688042129314943907 -2.7039869742318849433 -0.016031308900477363871 -0.12714748938000072775 -2.3733110540158839363 2.8379100276302255956 0.5067332237626858138 -3.326034737586111234 -1.4951161670397494774 -0.12936582842890290146;1.020043831556447067 -2.51085210247419921 0.38572287031549268299 0.51008325167155033064 1.0884626485721555778 -3.9117445478943482229 1.2472225353569303952 2.7322687678390327193 -2.3803571615080172386 1.4789274482030088098 0.7247101653707638258 -0.034348186716257250728 2.5285531390090438819 0.18638068992379877575 -2.2477301806181273491 -0.74703319225978026541;-1.7596896062555700269 -0.40688381547014351725 -2.0613385369661889612 0.15228601820666959332 1.910966817394903261 0.59051482794528020737 -0.44383115531801148324 3.9112007823302885612 -3.2356702027110597619 -0.023772453629004573067 -1.8432259456268009767 0.59084260508506580845 -1.8961877938923621389 -1.9399137074368768552 -1.2656300572541971938 -1.4037934949980062083];

% Layer 3
b3 = [-5.8022750571886874127;-5.903143591793812206;-0.90275226725102319936;2.5965309933377378471;-2.5840712378364787405;0.1180069869455431103;0.98965268779469062199;1.9041894361805264957;-0.786275251831809463;4.6384117090904535274;-0.034513450630424338805;2.9681029168250265826;1.4455310210560294859;2.5732159384335107077;-1.8371224573554267856;6.6943983116988956539];
LW3_2 = [1.9765830407966589188 -0.26210852070780937817 -1.7126861781177482591 -0.78734558718644220843 -0.515715004309268088 0.52290636294546632978 2.2746383673998367136 -2.1144893498133665588 -0.23983930117412607941 0.89893202046885523071 -2.6495092794973378325 1.1220767441443071366 2.3672873118859016905 -2.3543155172648382312 1.712575202555042253 1.3703765517262904705;0.027951252929306773243 0.0058066839238924191496 1.1159079465053711733 0.081477884570345493476 0.30590462564850762206 -1.5743262880969317585 1.5420424475663672137 0.36608388847946121691 3.0515061719383078653 1.7270896505897508355 1.65171784285046086 -3.6166772464576162349 0.18447027793460943346 -0.18290538901808461869 -1.6164138222760053853 4.6866988348313363133;2.1159236782866686077 1.3423170467179017518 0.84136847666259040324 -0.52047588841974334883 -1.3874180198594232571 -0.39087688600316128351 -2.0825794567793267653 1.5207531926596895566 -1.7138074996303993558 -1.5154783906510502778 -2.1511519444042543903 2.3211510348392683234 -2.5236527276229137051 -0.70717428056203013309 3.9803834667481696741 -3.1382260620602262513;-0.50019621550512038954 0.6686084831039607046 0.23813528379914469801 -0.68695069766342498063 -0.44867964235434576459 -0.59640712292145858786 -2.4819003233325012125 1.852045161689831243 2.5697255612371328048 1.0970497298729160462 0.3927425258683410747 -3.3982953843904963875 -1.3660397107343997813 -1.0087323449762104488 1.517784180887203016 -1.3056963359198645591;4.6671126127876556566 -1.8994935453874373099 7.2763645674549568554 0.18582796435931484003 -0.54858263924560835001 -0.70457522985343479238 -0.833221532897162942 0.485200100039582638 0.80353784106515024899 1.0325815467041530304 0.97082322399833698157 -5.5511521827567635867 -0.94063225540020523052 -0.33433382927169907894 0.15450706476930786692 0.87906027121453866879;0.00066300285803251590711 -0.42838498585337292379 -1.4459656933860749461 1.296963458054621432 -0.77781148475653438812 -3.3424970650323078125 2.8298139044142938126 0.2099104783521094364 2.3067963639181279234 1.7096011825445827093 -0.015869411809395821134 -0.70893328479357942129 -2.562278903499201288 3.6636466255959700966 0.75230627827559004572 2.1884114751777552499;3.5907894257031909291 -1.8983829467985240402 -1.0745990409033845392 1.4417910561238558298 8.34120929404072875 7.1983071551959563195 -8.8428485233556823886 2.1008424975380215471 -0.95997389268460164846 -0.60480481818340370292 -4.3841157308753420097 2.7293599413275764221 0.37706219711810695649 -1.4875197619018611928 0.16706107889389643084 -3.4790918070267693452;-3.7408105438117216224 -4.4626894733018209749 0.51581340832820710141 1.1698270184400061389 -1.462975055074719366 -1.646774168532068483 0.22948838472745364259 2.9358863963649901585 2.5401734988131323689 0.65544192036003778856 0.91064978658907569375 1.2884663242817018247 0.23885442718407315366 0.95798087607455562065 2.0299673344025972455 2.6965193665521907107;0.0011539314938958395579 1.6097717846231971439 2.2975879641556504751 -1.4461336251298846367 -0.36895909142372917966 2.7387878607955276067 0.33905346903057931307 1.2674627450843756193 4.6579430968131561031 0.72042384748290810847 -0.66855033647795558682 1.2022077968062063746 -2.7345493037271975112 -3.0869335378073721188 0.12821878214710918931 -2.6460998216806332906;1.1531871461086260489 -3.4311211196849900062 2.2532047819770211206 0.60622850296736074949 -3.1323197733356531458 4.7468065325520996112 -4.8108887872264656238 0.66255443458530371981 2.1990545099698426412 -4.7556484159346350538 -0.19687260074632945139 0.81298634265648062058 3.3537906676206632461 -0.6428879433560005241 -3.3398921150779536937 -0.49687358348363486193;-2.5331069735115039343 -0.024849749268416834735 -0.68493345930193694215 3.3910714724332597925 0.11897322292426475154 3.1115544042267995195 -5.3453570902869289583 -0.59209879380337748778 -6.8197072127843298972 -2.5645971010009871449 0.49179500975077572456 -3.6999180752583002985 0.59637303197573465763 3.3855283177945598716 1.2443752327035173533 -1.8157236857531384722;-0.4674829538819719188 -1.0699094145741856465 -1.8945415779500833775 -0.70289298257539523096 -1.9505707344407805515 -4.0606846845319690686 -0.13839756816454434896 -0.83133831402829505564 -0.31613499077395201819 0.084172527004394898098 1.335981687837845433 2.5838406400227467152 0.26051992051049904786 -1.3797045940158165767 -0.59018827081878422192 0.98149618707569130649;3.072062776067924883 -3.9700391369736003355 4.5247766280607990552 2.2942531467134221757 0.34052576388655819706 -2.0080985109532756283 -4.8768190795839405638 -0.15153701493896004626 0.21976730262629906587 2.6657205430048485084 1.6761800081439801602 3.8561004600790886876 -4.8984260222348385838 -3.5264312203844441207 0.40420041623705993405 0.16788873245569024828;-1.3938567446126965965 -2.4507803731214226062 -1.8861815799360350798 0.57304353744414249228 1.2870591594234246369 -2.6282901348672003117 -1.2303078112733378813 -1.9586467733744055142 -4.3672191680037686368 -0.51040199703075073145 -3.123176688579128335 2.5643641057672676986 2.641724871628274407 1.8258973175934298805 0.65286969003576278414 2.5687416724567344595;1.0372587037309610736 -2.1470286921097634369 4.4663183148184772975 -2.0696013431688351503 -1.4678375734748965176 -2.3054810682985920067 3.2125977279634838624 0.017352833254803419483 3.039605691856069658 -2.4851401649826350138 1.9638199053654470383 3.717884388835345888 3.7212486985479213963 1.807014036930138845 0.92614028260744807319 -2.8681166776996440682;1.5583959541750276312 2.3920542650820970643 0.59168711488115821595 -4.9220720902540007202 0.34131549041138331546 -3.0936355209784736076 -3.6040443285813497099 -1.8236795282913120797 -1.1539196086919500939 -2.364139231120704121 1.709441923135311292 -2.139548727277437834 2.1938173949150963082 -2.9328661554396466826 -2.0257326334700187509 3.3911024901560482547];

% Layer 4
b4 = [-6.8605140833122684185;5.5078823710243183243;3.9396696764112939526;9.5839906278269140216;-1.372781496398889578;3.38179783937248013;0.982112175893662398;2.6429570578671355285;-1.5305097680839105934;2.1379031570967090836;5.5046864453530046646;-5.4536669035161082775;-0.35448406105904900487;4.0740047851486611563;1.2756885449673074362;-1.7958763322554354147];
LW4_3 = [0.18399032155269653965 1.5703043049420952748 2.2162511640726489937 -2.1364182904006945307 1.308264510665629432 0.40800405217040808248 -1.8180440450064014879 2.64987913239693329 1.714353353524603607 1.6980420103078679439 0.33925206025217441441 2.3863646594694833958 -0.040660213847365837825 -0.80913344403783249437 -0.65035897463066139057 -2.7211223603132550508;-1.1237671888308271573 -0.56249348073327742892 1.6668859552947712377 0.87540844881876933581 0.53359360940217037683 1.5664374777309721942 -3.7384972828328848493 -0.098389079372643642452 2.4392011076467832176 -1.3582481936249906074 -1.9208619384689604725 -1.9838408064899961669 -1.4524700256680178612 -0.42336257595221199468 -1.6920675507499154389 -0.24777642052263423866;-0.11420709910608943527 3.1700888681584267204 6.2184983628954091373 -2.9373947045101624909 0.55057356068375784552 -4.0172342399673741653 1.1820177213446394493 3.8457515750941770882 -2.9872093732353692808 -0.69648170933541886374 -2.9629382686935761271 1.9242145274488176021 4.9531835689895391539 -3.6672033503880165917 -1.5165282082600213265 -0.65682922814862809702;-2.6414189852828320326 -4.4605518788297544575 3.5184684868552076331 1.0526129519919487088 -3.6481809026346971869 1.8069417227170831985 -4.3540535100894413034 -1.2463135926942301435 -2.0952738664693999482 -2.0359230441077169615 1.4954765978000503779 -1.3077651557077354383 -0.93282147507996271418 2.5079457339789064108 2.1717866087782220497 1.4635344125224714062;-1.0117691416013745442 1.6803388144150148698 -2.2910922700881184433 1.8563243426138595904 0.82219820389596964816 -0.18674837965561896791 3.3018445295292631059 -1.9149990150031088731 -0.0061292332605707017246 -0.88357919213616753495 -1.6364841753018390946 2.0836163601196435735 3.5593956368247479105 1.7274977912463078678 1.1323148465637045135 -0.34649672260520203437;-1.6358546260568216368 -0.46539394413227708203 1.4591792114640140809 1.8374375351302547621 -2.3951361135326645346 1.1380388569500519136 -1.0496309083824473252 -2.739984240767458612 2.7852786680719905377 3.9913436402865043462 -1.1248749852777042424 2.8414985348584247404 7.3484510209361220134 -1.2124304732194681744 -3.0143382795173430111 2.421864600382835242;-1.7394618122034475327 -1.1828181343617074628 0.39055383066796323099 1.3230874245256170063 -1.2895177127129520134 -1.0534241928499072927 -0.70360077389131125969 0.75782369624923040519 0.33619284009304878369 1.8720194110329588799 -2.3069934091010497745 -1.7659668733615894176 -3.907770776539133184 -2.8371273515640109686 1.1371591023955187616 1.7522730238757868726;0.67190765775601102305 1.3793850859283809385 -0.51551231435432265382 -0.064226054472500571091 3.0748802580364333892 1.607842696848344799 -0.24212687608930719141 -2.082043601902262786 -3.1058900611589925767 -0.29676457297458402884 2.0565743288261963961 -1.4753080448966369165 0.43047052809380897953 -1.8577928653787068036 0.23909268891598253748 0.014682923305935305369;1.4320076476942633636 -0.48470237709933527981 0.52841683220999269288 0.42373531218166649026 2.0091149035817745805 0.69571536888923757314 1.7116699141908431336 2.7354027119912118771 -0.93633062517405063474 -0.38913767775326424392 -1.8754993148834255834 -0.34118004553911346344 -2.1669673397747870602 1.5282955177683208436 -2.2824279030567220516 -1.5252895172451619299;-1.4337093564558676118 -1.1907103331851740524 -0.81540794235344882246 3.5735813829832423494 -1.1775653024668797375 2.3184053635222623413 -3.5133194972991566019 0.9965649496904793736 -3.758558406062462165 -1.4694805107770119168 1.816340699081707255 -1.0276285347995406383 5.590319417185546591 -1.8263928038183219194 -2.857637830139581947 4.8627056703416178252;1.9616520740086293983 -1.9618660937214660311 -1.83979221692452799 -0.78545080377535703153 1.5463127007436174853 1.2951435597970493152 -2.2694513072525470676 0.0058524924924705044177 -3.1154001278409033659 -0.23266816335769766044 2.796587785481249977 -2.696459196066963937 -0.84828972974651151162 -1.4326370030234281128 0.084730669225327556737 0.053935742471468414716;-1.7850745792566087289 2.9984527425485945074 -1.7459437454967146053 1.2987561190842209502 5.899044069698480719 -1.7840231810152613612 1.711776001139822645 1.3350677057431608041 0.032875822390759180947 -0.82444072729501849395 0.852244272886286236 -4.4123031880838547991 -1.3843726101406790274 -0.85816722300860681649 -0.50250844377954995146 0.92056300534092261323;-2.4421625489193505842 2.5510997622650628536 0.30853779758493926622 1.3339456804140912283 0.87873121490601069361 -0.45819220119020448445 -0.80627638975554305478 0.27373029694497463815 -2.1588066466302535673 0.23887141872416234323 0.62311559867499155541 -1.7745678651517946545 1.6404497226179464153 -2.0581300839985372519 0.82547754140187390437 0.58146647405182272372;2.4890337576411520892 1.4646802874956637019 -1.4196211891128616145 -1.8071528824284437409 0.00082974910381667342507 -0.71438169292206188388 3.5956286326741331294 -0.0053117413899129517843 -3.3794211127660926941 -0.83068670195766758368 0.86294871547695661818 -2.1975732352376540213 -2.3998868273441860133 0.41872400709313711831 -0.67603124888305943241 -1.4359306913352567481;2.0213834492121032227 -1.5615006101028665597 2.7978996743218322862 5.4204940174064955016 3.0586762212395832705 1.3954215834157766007 13.405402792988146743 2.3257421893182783634 -5.3071480046022969645 1.6476592868974833106 8.64768151908136673 -3.2266220040137558733 2.0316370132110677105 -3.8653023989475823186 -7.6907677418838193972 -6.7990713292362583431;-2.9095766139994370114 -0.73156617304405446855 0.39067123079512910966 -0.2801176303372532872 0.7033960081314637458 -0.51604306480372197363 -0.65921224772634945399 2.7743619707631057558 0.42054273909822303956 0.67003710275872407909 -2.6706698525674847922 -0.77472232717425459914 -1.8896437144604174563 -3.3983490793451696099 1.2268163504625182458 1.2954104974350511004];

% Layer 5
b5 = -2.8101721513273112407;
LW5_4 = [-0.20333993962199353733 0.65564236047815260822 2.0065300861783574859 2.719106072235987881 -2.3924879993444192472 -4.0008584683854877539 1.0530691164199526 1.6608072201923009814 -1.0628551934151369007 -1.7222367759453953706 -1.1142285496222752439 -2.8374805781220731049 -1.9235005226236450149 0.508624309096605276 7.3808263181984905543 -1.4950480627094089314];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2.73503182618227;
y1_step1.xoffset = 0.251188643150958;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = logsig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = logsig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = logsig_apply(repmat(b4,1,Q) + LW4_3*a3);
    
    % Layer 5
    a5 = repmat(b5,1,Q) + LW5_4*a4;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a5,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(5,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
  a = 1 ./ (1 + exp(-n));
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
