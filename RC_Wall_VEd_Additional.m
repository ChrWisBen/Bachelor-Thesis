function [Y,Xf,Af] = RC_Wall_VEd_Additional(X,~,~)
%RC_WALL_VED_ADDITIONAL neural network simulation function.
%
% Auto-generated by MATLAB, 22-Nov-2025 14:35:47.
% 
% [Y] = RC_Wall_VEd_Additional(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 16xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;0;0;0;3.90287575591231e-07;8.04964160217025e-07;0;1.72101586315421e-07;2.99334273812235e-07;1.34723020615013e-05;3.63334982278474e-06;1.0375616036562e-05;0.000278533057098684;2.12312121661284e-07;4.25732155751035e-06;1.92152362910036e-06];
x1_step1.gain = [2.00000611759814;2.00001664096898;2.0000036222745;2.00000132953614;2.0000109345245;2.00000176072692;2.1780447300567;2.00000095254436;2.00000792631557;2.00002894585641;2.00001548438597;2.00002124749298;2.00055724893114;2.00000274718873;2.00001429616616;2.00000700766395];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.3382191945680323997;-3.6467897852670412284;3.048205827067238971;-0.98855452453479664143;2.5068289012582600783;4.2027710957168675776;3.9985775138872741152;0.92646137830946495573;1.9097957831236920256;0.30546493241094191395;-1.1670390833455290824;3.6090125491001519009;-1.3962372076309852442;-3.5222827064093471527;8.4291467818408847279;-4.9565820368945407992];
IW1_1 = [-0.19381092899608834412 0.22721287801618109126 -0.47721194914896941652 0.44358517016303505853 -0.020693354228386414556 0.15701623608034889767 -0.8095246274745458992 -0.039017695014309447532 0.15346629236780878758 0.73095748994827336453 0.39643939723859528135 0.15666469629565052402 1.8034406925752031192 0.19317530846446684389 0.33739438995175524694 -0.062735861193775985245;-0.10240732311114131292 0.0049295897695441244502 0.0094157505780891499747 0.0022913380654142685884 0.0006995478045501481992 0.031138186487060615787 -1.566081513526936142 -0.0016048676119557066504 -0.49176609098017037836 -0.029135868349264088667 -0.011043949574979458964 -0.018080828050656441025 -0.079059271025462854454 0.0037137197567096388341 0.072267909551004219648 -0.012737719322064286476;-0.82760904668722734545 0.00339393405241105936 0.018210935967581359796 -0.039320606105063833635 0.021388708111740692419 -0.57757346566697276291 0.59136821474260903297 -0.011343529156776650454 0.031840041946160670128 -0.36655839650570631871 0.038955795490785330437 -0.016297013251814929102 0.039748523924030561283 0.017500522243248977511 0.06525638937517026783 0.016388402030279910354;0.25152182655727195471 -0.004460117524468409228 0.00046202072446703979641 0.014473413912498515194 -0.0012261924493655149311 0.00053861418807086788342 -1.0389940861977287057 0.0015220963365153690819 0.014231784126199381602 0.15516900668110444883 0.0041884706871211860313 0.0060972899678269684015 0.022048744086262360431 0.0051526999647253830805 -22.35523752383509688 0.010023337557414286822;-0.6638186856008913006 0.0030187170116707340121 0.0043212907005571767061 0.0009476534317026171373 -0.00061725099667214668349 0.10379090187274807311 -0.36658851878425602333 0.00032691272584195474066 0.031815957991374273217 1.8902364104638964548 0.056024009758936080261 -0.0022620447925461818414 0.088735396042948319617 -0.00034631578256329100408 0.008574198125960672337 -0.0029445847172288991921;-0.79927786492589325551 -0.9196404898124261873 -1.0836813081276543969 0.024279177963531343998 0.011084975773799514431 0.014830265738227937575 -0.8382134883446097362 0.053933792344926727302 -2.8307918747964020412 0.61694898597187508571 0.10816202944332303781 4.9459513034101485474 2.2985519661742950248 -0.54677333918125525791 -0.85341596122953389258 -0.12417725923949538003;-0.31096690092490580914 0.0033615590400660698943 0.0088349844491048268313 0.0014252648873753362771 -0.00054818288589549360457 0.068800195399592908863 0.26691204906006765762 -0.0016687482097534494813 1.8870829480269872835 -0.27412432801578534569 -0.012564185896355916858 -0.016811747646945589263 -0.084159629542480240971 0.0042439073251087713889 0.066393963439831560347 -0.012914218961418597389;-0.3837199970077868616 -0.0079786029027399969077 -0.007317501069926017794 0.0014318750114234580877 0.0027825657507677763712 0.041874835992055395306 -1.5436450500165959099 0.0046894616478678563878 0.084283178245375664495 -0.47111935725749248816 -0.031041480017812875941 0.017570249173932701164 -0.00043096861758029495273 -0.0027465227981735198387 -0.075875983946656760937 0.0081455052878061061372;3.9604236258532612425 0.0020017378775824823389 0.0025624464336196184182 0.00030935535822991500586 0.00059013349653051186579 0.0013150536525159939837 -2.480204549355597976 -0.00063155424273489250715 -0.016290245950990437512 -0.11952377423420267044 0.0052823891666806885303 -0.00061843687349463522408 -0.0058789384887239426111 0.00046715473013647483298 0.0068988846240685694836 -0.0024896476083400742758;-2.5530160521802294227 -0.047555247355234440965 -0.045616165312851092439 0.039771778494148674055 0.0039539800617344675326 0.040009173347497463402 5.3302006715765859468 -0.071176824299232915871 -0.1596838273038297118 -0.38589865020079650026 0.037556447190046145235 0.028165807536573279901 0.025657673938109797074 -0.0041549899523809991422 5.9670988281097052663 -0.042280345161820123701;0.76843264837377189824 -0.0023322170530040244908 -0.0048660923418540336094 0.0025173360190633275318 -0.00086626227184155709868 -0.051847758494418964836 -2.1511511691026083959 0.0021035670699279147844 0.026128068937246687331 0.59642530798862469776 -0.0059210516507948252399 0.0058546248473868795284 0.011607642011875045698 -0.002531361002376257812 -0.035328597650644409656 0.0035563785023322307295;-0.52931683309245236568 -0.18729921968355051076 -0.5975046329602637929 -0.73347675556298341792 0.021792604325550860717 -0.17567480051598721724 -1.9210193785929767785 -0.13659411375029750779 -1.4126219764051959338 0.59089383184101773594 -0.067767282973768536158 0.14945628531433793884 1.5857935340240900679 -0.26556345551618604217 0.14949635293626883925 0.18665744262587180557;-0.98261121195569622877 -0.034779078485480417748 -0.17054686881795005915 0.017664541927282038231 0.040745419781531379277 -0.024703561530525944973 0.98155806638308773504 -0.040511318366119236645 -0.26106337649126537537 0.20787163986155676731 0.059207706512121670295 0.076951766235015692241 -13.979759940249447681 -0.024952191265497882661 1.4551246479634638575 -1.5690384508872379232;-0.58637091626469339811 0.19795480754791111577 0.87801903090452093625 -0.18873725481819131344 -0.033886279250450609957 0.11821761505198991049 2.3033918873574052988 0.0178849093968110745 1.2117607900569551393 -1.8509538856578544586 0.37341794465183969498 -1.8136490687977528946 -1.2869138611901316249 0.34655692602452947693 0.29085516272641342983 0.17459931826217034434;0.95839690472790661779 0.0031845555569248815836 -0.0045902328170264556848 0.010108673550128673829 -0.00025989659312427763156 -0.042610013115594300159 6.4184832580680195591 0.00079886537548942845258 -0.038311570691968568902 0.48107297826985379041 0.013996099150301677047 0.0080896099067426837509 0.028654676012642911476 -0.00015010537166614077581 0.011351811425797804847 -0.0031486774244091236298;-0.41173400505528634508 0.42257209446664673047 0.6832433237581752028 0.45604252576398479624 -0.20542306284258848859 0.14726239616932104703 0.87637483766454604694 0.091984049976826881556 1.253153827005894172 -0.74753322501507191156 -0.2342907922895827999 0.24567778337666912325 -1.3113980404821676817 -0.31306198224661047069 -0.14601781115659354104 -0.32862994542768408923];

% Layer 2
b2 = [-4.2436599698385597534;1.1035380553508189472;5.565727761488147074;1.9456795187671274139;-4.5369542094392754095;3.5030988243060923182;-2.8889871714093522392;-1.6982925272919089377;-2.2722889532213761399;5.7252247206994439921;1.1361463916214438186;1.2386191826917325454;-2.827468726851229075;-6.5182618251661841313;-4.4010017111509869281;-0.17628462660306704057];
LW2_1 = [1.5499214717968572419 -2.3258576858889559169 -1.7327055666702093628 -2.9852895500260308026 0.96000120949917777669 1.6331735348521989604 2.0680809709341985148 0.49844845367179196893 -4.5313981634249316244 1.2550714452083482353 -0.47995454114892383002 -1.8241541761668922383 0.29625767026643445856 0.929235512513748807 2.1472629568646852682 1.641654968086452504;2.2128899429828683409 -0.91853628126843012147 -1.3687843832097330576 -13.262042449206164818 -0.45027689973969786674 -1.0629115344045949598 0.15151635072247757186 3.1398261419520756554 -0.52602477344530640391 1.3085461487711642636 3.0466092779294715598 -0.076356564389495396039 0.77114738265252413818 -0.82255228031427163327 0.6997246757404083084 -2.7760219724976535893;-2.2563099806444273376 -2.020602504184172421 -3.165254472505017791 -0.8494490245823652641 -0.32348369903838236628 2.4802163670545578356 -1.8387371234742793114 -2.1343358374273346811 2.5760812086292728118 2.1083086189459447901 -2.6114172668793353971 -3.4097950175177773602 -5.9163288773793460962 -0.92929396358283755664 7.3609483979664824815 0.27969714983266291686;-0.25982131239374162135 -2.4016284200779098867 -2.3496877801133755348 1.1016895552462413477 -6.0299962992702464959 1.4689760400725042633 -0.50827829445117722607 3.5619176148108486757 0.13608504713705948941 0.038835620647974800068 -6.7583721854476719315 1.8341388206743245437 -0.20921535262163276636 0.27192979505812586716 2.2712376442912947105 -1.5968936607748751566;1.6368391722413089262 -1.9427938034456586625 1.1928309408794479651 -1.290604163607277366 -0.4856565495472792704 1.7648831514181555491 3.8963114814757209281 1.27157266656327117 -1.8378130793819815736 -3.8038210318386625475e-05 -0.31480673339721254589 2.9045580889527347068 0.66111795562931185977 2.628622469832179398 -3.3810493469153750645 2.384924192321924874;-4.0103324648522038487 -1.4551555082683067521 1.5158262999422913442 2.7796473257842562177 2.3244586700919409594 -0.95727417456874575041 -0.43916342386019380228 -0.9593827967494519271 1.5911745479478072163 -0.11600503542390387668 4.6842180932022676743 0.33874146924881398668 -0.41491828032882266397 -1.0045103344441035365 -3.4359097551913131419 1.6531706428101475836;1.6068483083930558131 -0.58746209401431725983 1.4216564837466514337 -5.2161719749248716127 0.99215648113778998063 2.9840587874572563898 2.8255062884041159954 3.3428960623124024387 -4.2969234832071308006 -0.0085527802866696180095 0.99857595841924773339 -0.66941691973777561753 -1.2142857429234665823 1.5877221575796267583 -3.4652338758681988651 1.7087635943132570837;0.57173494474612429617 1.164296594491498249 -1.9861510784974607535 2.4624733258105546696 -0.5491369208554949255 -1.5497683411806231213 -1.4351785168600708076 -3.2336479329679312933 2.8477525590123091703 -0.62447536350735899369 2.1752375558486889418 1.2750163350120489181 -0.29386305796974060422 0.41976692282153682534 -0.25432529140718435068 0.24064517732429932528;1.5847786011411544305 0.4651435018944783395 2.1469997551017869775 -0.48442801375831956445 1.1921031723765844745 2.6498454711394496819 -0.60133471877225519453 0.37813919356031722163 1.1878388025515678184 -2.2748241071191142026 -2.0194902511976118298 3.2645654618453812112 -0.19312175589413654864 -2.1391512528887020039 2.1563932172313080571 0.17239748034927865339;0.38977363618492094632 -1.5749618404569154517 1.608394055970436165 -1.5820103066277670933 -0.76568489265800299126 2.6301515896363909519 1.7521470154296752142 -0.68840840702829564357 0.32805712391093244662 -0.069712175809662921266 -2.5688273889709747344 -1.8912111475933166549 -1.3329752854992071853 -2.9970304591906895553 -1.6599273462844794658 -1.5563859252777509923;-2.2714328716435376876 -1.1811952317413287883 0.12504185838074496906 -2.9460472661567793651 1.5414871073113722844 1.000495933041295249 2.0338440239072581583 1.160531715645024553 -6.5958478584319184534 0.080649628958240737742 -1.650221861447499494 1.0635018963605655795 0.068543175952950577412 -0.34526399425851650449 4.5580244407974683796 0.026998283587003308465;-2.9047541297572108121 -1.7174038390083035122 2.0430744411105945524 -1.3134352183971351735 -2.7822510246518388222 -2.5765108694520373334 -2.2624304638322474403 0.30074233274654815773 1.3956377628477478758 -0.2138461869375872515 1.029161694692300566 -0.69512670400628606693 -1.4708711731305468273 1.833338252003894997 -0.23774999351766623601 0.69164485702524325372;2.0709664428670770953 -1.4247239659041834869 0.28038044401024092567 -2.1202167968217939809 -0.036855772895398250522 -0.93565394028324233577 -1.365669340074481708 -0.62669362998502486928 4.166939234944835313 1.8435244398399155408 -1.4185539635988793083 -1.2001450620878444386 -0.049608982840063667319 1.1598174651963331083 4.6967659491223692214 2.4715101019001597393;-0.086720456968978301693 1.3397046677017261374 -0.60434538871669496451 -2.4691594726115209113 -0.134463510748395354 2.966081143665995512 1.0562514966941081163 -0.54926981338529901056 3.9959301224703684952 0.10557881503491946262 2.0895980300966345844 1.8029201572369535356 -0.41076190740703999449 -0.53348014785582320574 -0.28859351223751006366 2.2120592290763902987;-2.4867005630196232779 -2.2930312788393383272 -0.36235655023833085453 2.1989273321473676859 0.75617565008334231003 -1.3413885830243998942 3.3480851510630298407 2.8819140280156121392 0.83289048489346506621 1.4822007134025614317 1.5772174698360228451 -0.24655970081673711514 0.99036975952212258356 -0.79597421020685865667 -1.5707798192141666505 -0.2530288198340915895;-0.86428971174508895103 3.995257877614911024 1.7451017407721431951 -0.36772319350322563158 0.94028514412064401196 2.48753588788897817 -2.0101006011455213596 -1.383448467422186301 -1.0786216639444563548 0.10769863283499075957 0.23094023036146657524 -0.65003447516644874415 0.38032227577871768887 -0.23426305127215479862 -0.73517185932170714402 2.2515571660270308207];

% Layer 3
b3 = [-0.96402250099284236828;-1.4261492339342658475;1.2425159899718416501;4.7261208502250866559;-2.3025595680839412438;3.7879569290025663086;4.5101077116194385752;-0.67807180346040463181;1.3553595623697254346;-1.704006385455558048;-0.63220603986312495781;1.4790076408425798515;0.009735609282594698613;-2.1051912902350364831;1.229295160833892453;5.9202970713192915042];
LW3_2 = [1.6703291966993611961 -3.1978767802609784354 -2.9439285579724097097 -2.1207503533728018219 1.5649942937450633806 -0.96050844166585558348 -1.1716992802587415934 0.52898603740309302346 1.7659908053454651533 -1.7570654004057790765 0.89808230546519562942 -1.4155723073488710728 0.21587984876381743904 1.5851357600444859752 -1.163693579008525214 2.1204692251535810499;-1.8136174993654696763 -0.44584432762593206867 0.18774509169040740075 -0.5885344906622828054 -2.0546521713582253099 0.39626697817795802914 2.0713896211716127382 1.1320270067980604534 -1.8992988144592182209 2.1786541751287256119 1.9088317801519361083 1.6943496083261708751 -0.9276901445688915393 -1.142159922747587153 0.3302570089487239513 2.5427850671429439444;-0.36168708463047699597 0.097549783196183917355 -1.081652220374591078 2.1869459192213080989 1.8005051344699729565 1.9763291975154471114 -2.4894535467104650373 1.48101560293379797 1.1578318191307346297 1.9594934326521862289 2.3371015133075805359 -0.38706748637439275518 -2.3034750660043727954 -1.2797746179127069688 0.056431388592511400049 -2.5416582155478510963;-3.7632120230117052095 1.6637046039434915112 2.388780902242448434 2.4877959063063963541 -2.2039541683908545622 -0.27318596570673020496 -1.9340581364297033673 -2.1057702707570253864 -2.4180319645270502704 0.16144451134155626826 -3.7450722693012448161 -1.6311154031504986328 4.1219105571906506924 3.8834792392045089926 2.441762272480958007 -3.525589642732857687;-1.0886830642858569274 9.7907804413230543616 3.8518907916664697488 1.9164404962542400668 0.50536403639854610148 -3.9435646693826780229 3.6244273735638925515 3.1905026014974460224 -1.8855010624583750101 0.79657135958163038936 -5.5310641673349705272 -0.074191561147762041806 1.6110572119870203434 -0.23861684371420158191 2.7408373097920120109 2.3961406787418466635;-1.4039052041133033288 -0.46408820308935178067 0.37275785935349942113 3.3756590538339787955 -1.6978474334786488598 0.22580023789520067834 2.613029851819856475 -2.7667219601538297624 0.016762220835117098289 -2.8473778148264941024 -1.6556488572874454857 -0.59434646236937094255 -2.7360235519208937482 1.1416650776836798631 -1.7623840500759275773 0.89553808640283272258;0.46888843697500581786 0.059604242688718285514 -4.0723073117408201682 -2.2647002392031292395 -1.7156115270901786118 2.7963765177176513888 -2.1931888200924696264 0.047442211070627349212 0.41385035713513579347 0.87965116425491884922 0.79382057955205054256 -2.3166160970835290023 1.5239649727788797673 -2.4666589758736354732 1.217869561620708474 -0.34071860465777525917;-0.051329018329806908039 1.1120164182401586217 -0.27072492159083283436 6.6000221797907689947 -3.112266875333930205 -2.7426708590022594869 -2.152363085417921873 0.15223316902094194414 -0.86703133782624686177 1.97011435542158031 4.153625822555779834 1.14397703505193582 2.6440797139370371127 -3.3818708956072365268 0.24603193565579711821 -1.297382288126707417;-0.83605177211269809945 1.4416754484690483817 -0.98713098080582117877 0.52690988232448199291 -0.89256304240315886833 0.62372176418852209867 0.031284456261897561347 -2.3674949281435369031 3.3364027656000523336 1.308365909910635505 -3.0204583648808753793 -0.44804931318711643806 -2.8973985607797740904 -1.1135223910287221916 1.8973935482979098488 0.5099530612363907256;0.857111196478846038 0.74967028785867195761 -1.5765797401569754399 1.966504668346444884 3.1674587197755346146 -0.68987116404979753614 -1.8787256041157471831 1.1868424189276232106 -1.3084610917454626566 1.7568843890557306331 1.9091839457655805923 1.7422932325580879898 1.0462480955639674729 -1.6461668768002777341 -0.61116970178678309278 -2.3687352570906905491;-0.83420293528701539021 -1.9247844614628593085 -1.3590348003195218407 0.46009824912081326298 0.31560095523063158574 1.7239237463857082222 0.48225668788021219813 -3.4626751571074136926 2.0274158468232359454 -3.3870909731780911578 1.5896393591737276729 0.0058512976822088016982 -3.2114057858246041199 -2.8723984528630190916 1.6751789681909325935 1.5328701920191871721;0.2551720233273941929 2.8723058078630518963 1.9729827857358948062 -2.8201060352018982869 1.7877224531663393758 -1.8665585091685399366 -3.5042700445357053418 -2.1353980760353343804 0.38966878012598771264 0.58791475710858887016 -2.0867047402008624957 -0.29198327027031378833 2.525285798868947662 -0.25311419319104921932 1.9930355750347665822 -1.1586143520892517866;1.3915751826183984097 5.4429026487220752983 2.739857371591746471 -2.2829708177304914862 0.9981269081553489908 -0.56538035271726427844 -6.3770175431137534616 -1.4489319845688493071 -1.0253910361690661279 0.52314615349893345275 0.30616004013111675075 1.657676979234321113 2.7155685990686446729 3.305245805028224737 -0.52436742085516652168 -0.88213709756106728488;-0.75343953202411872994 -2.2210500251192577537 1.6475209002621664656 -1.4226508768224224166 2.7811619628592763043 -1.8768462133043364304 -1.1374902244213724867 0.2683892397509288763 -1.6280418236355189698 2.0662431103935721133 2.4507763661944830247 2.2311834081112063011 -3.4321436268647498302 0.049686444713493899128 -2.4495946263565806511 2.2373650444967778661;1.4254916985936627594 -1.7979989128153328615 3.1544985823992091056 1.4703244218678639399 1.482024410406332926 -2.4970742416105222716 2.1511413839324418085 0.90473428567429914349 -1.980360544648244181 2.3654442211926185458 1.2990607741230741912 -1.4687492145588425529 -2.7997359536522958834 -1.4449068214672859956 -0.79557351355996963616 0.35321106304204574755;3.8312781331031557919 1.0555533663107536935 1.5005471011411244397 -1.6761128270593506073 -1.7739124616519716948 -2.3247511059158458835 -3.4821807971188745157 0.88128327938451189727 0.30801401885977230943 2.0524170480133610006 -2.7316538315626570643 0.45451248518593156955 -1.6677561353234713337 1.206883971169851133 -0.61565336115410529416 -2.0814419968937647454];

% Layer 4
b4 = [-3.1845833711139790445;-5.0185701193513603258;-2.9184959196239423918;0.074306465704570529018;-4.0874193664407485471;7.523674239736340752;1.6262104708835152245;1.5346428817277053547;0.45140379405128183699;6.3597953569501894933;-3.0105801404262733101;0.33739693135558201931;12.250177759743831274;1.8249389365274788499;-1.0539409110044359874;-2.3238274412839894367];
LW4_3 = [1.5428527085116516826 -0.76700894725192203527 1.4346707597826093838 1.5606915872754159036 -0.6992652893496333899 -2.426539047755463141 -1.6490924967969342596 -0.98834909026824890876 0.1542107682188159079 1.0976191867889444342 -0.70411188302609106771 -2.7715549943217001605 -1.9330258649260376735 2.5592721526484156769 1.8701857071401182253 1.9864315958209255442;2.7379827842326807108 -2.9791955547532102955 -2.5690783625432729309 4.6399655865122939602 4.0924784264831277625 -0.15717986904979436291 2.7222956358901524432 0.17880569628980791386 -1.147158119919386321 1.4998184932483893395 -2.338474354727997806 1.8012695376396106184 4.1631865200244968506 -2.0184193474000817758 0.23229523896093307034 2.5912834659733952059;1.7956958078785958399 0.79845010218028045212 -2.2902032416747322152 1.1922638314946043536 -2.5768556071192478818 -1.2223031084396354107 1.3421829774731168783 -1.2033404933144793425 0.40834284387545621842 -0.97537499332937138696 -1.6364736405765578642 -1.0906961709136939742 -1.9487008075179972355 1.2886246833453498528 2.8012431642722908087 1.9418105425834197852;0.28280826900013439351 2.6063743532455321272 -2.0324845437044478658 -1.1646932030779679756 0.78143784696159523939 2.3298552517083064295 -0.37486271539097137939 -2.4292338088669525042 -1.0962416018219685032 2.2161182984109633054 -1.8607944496804429413 0.39909085044656961161 -0.89762086805365026709 1.4665694227107868297 -2.0517374027993451335 -1.5511648719771009564;2.295630028504679121 1.9807582775322927215 -1.4775637693336827194 -1.179741587977139794 -2.8153598742335392835 0.26404279757915616322 0.38928638527861270102 1.6921053408853938826 2.9363644020465469175 2.6334023564592428102 0.22220154225227120581 0.052634237637356598438 -3.2980454532250900179 2.0186886051960417632 2.893917100637307005 -2.7323413065364854369;-1.4839494173737988181 -0.36220494975119549297 0.94019747308382894957 4.2171667845827585097 2.732365938802037153 -3.8822850271169730973 4.2503851589599586092 -7.0612765043158587375 -1.9680558694903740324 -2.5056966295976157433 1.191430474927794636 -1.9411155388662548749 -4.2835408833007901919 -4.1996111855731976803 -1.09910424969011844 -1.3450189180950218315;-0.26757813518804024477 -2.2096355785485708445 2.3807475176897261449 -2.4946865674537073154 -0.14868986693725069759 -0.73592390118383022024 -1.3376053732686088438 -0.063930633726951527351 -2.9592218926396358647 0.21012491636078914348 -2.1565032455449886228 1.0079512025482066928 2.1862704425510632866 -1.2580723189157640984 1.0212931851965556529 3.2765404528743666823;-0.23616068045953472754 0.44333967652059003139 2.4609770051763755205 -0.56214334806359944618 -3.0327136175778584004 -2.4377050225818748252 -1.414069429252760024 0.15866066759858349355 0.68228946234733489629 3.6964701853575170354 1.8103752355137407992 -1.8927409797223968546 0.43569791591370726769 -1.9009820882511685447 1.0314888668158985752 -1.1292328104365059183;2.6912383880976706862 2.9787794706286856439 -1.527029162899241399 1.1217566488350831921 -2.3773175843564673393 0.23851071793534245336 -0.6621786334913146721 2.2242520000137369074 -1.6047027128900330784 -1.7720326535268415835 -1.2093827811796176164 2.3259752837113096824 -1.0545156368049080076 -2.2535730285680681817 1.3873010038283888345 1.5599306341278937893;-0.89309933515355410805 -1.3017610488145716641 -0.69576231314417968932 -2.9410150441661704335 0.24369099341667871395 -1.8112046196776263596 -1.6849844937436671 -2.7580052471680911452 -2.5931338819348646041 -2.8255154296799691593 -0.27870468095730271951 -1.1802926242385038957 -1.1003895631111275666 0.68044762613601705858 2.5217539815899070454 -0.83607666561057869536;-1.0990782248458776937 -2.6744982719085057532 1.0981226396024563741 4.7856950758242788879 2.3575737472634434866 -1.8818183995441042367 -1.9480490436816793043 -0.35965366605416893009 1.8017973553717590018 -1.2160695283167606284 2.2518665206107804089 -1.0555746723420842414 3.4513633310935811771 1.2790359270775351064 -0.97997799089175274823 -1.1681314673421634431;2.3841527322703393033 -2.4779990338346511436 2.2737123571333994754 -0.66514442202691348438 -4.7522918553361801486 0.97068106071134374613 -1.6319317529963146551 1.2231705402926462689 -0.33206143740226945482 -1.7540430693124051675 1.1206633831755370423 1.4481464026351658081 -1.7542606529018400785 0.83539775653933556754 2.1363194597065287006 2.6859157079477955499;0.085727858302418274983 -0.84871685763191784257 -1.4753433825048600792 0.51384028454644825601 0.95585328959849513719 -1.2201135647544563145 -1.9534367089594000255 -4.0955198459878481287 -0.63351066241288400693 -0.8709206350500529048 -3.0498865475906757894 -0.66758308005883737479 -1.6337852072571616979 -1.0038045491637654916 -3.7305776988867402899 -1.3400129141971466318;-0.64351772358908609917 0.42096259005110830964 2.3611865789700687834 -2.6545963910739387437 -3.8684864078127456644 -0.18530487771060444313 1.1126894161946510042 4.3453509383722463966 -1.723723750927964149 2.0014599063793370171 0.5376585751669146207 -2.7666029802495715195 -1.4239576853710467219 -0.056256798262284302137 1.3610227279350375351 -2.0677582411237813709;-0.7099282504783391845 0.067999743695017211831 -2.4310504810590409797 1.9791117939061912967 -2.6408421724955308818 -1.7298653412070366109 -1.3591487826065298261 0.89294352081108241403 1.3246341118914806145 0.34260768370192729027 1.7302748779828791559 0.37677787309267907201 2.8364203405724488505 0.80303518678927798824 -2.4812613857927563465 -1.2919954128885040578;-1.8386127541143728603 0.37797525025912392937 2.4427774096539223159 1.0940438118775652754 -2.766400763292661491 -0.42096518374042657396 0.94967080606013720701 -2.4168787115955270295 0.9469426067437646255 1.5420699879112018671 -0.77813877952493359924 -2.3792896183975691393 2.5200877193596276094 -0.30103963831131969053 -3.2332535106291286908 0.78555027161189827645];

% Layer 5
b5 = -2.2929669639937566572;
LW5_4 = [1.021472665797565238 1.3769864369850761676 -0.28497082681384755531 0.95895042273920128029 1.572670542193393306 6.1529932964786260285 -1.3159678507152889892 -2.3076296543743479717 2.0867126610602020342 -0.33272884290057808121 -3.5003457532219042214 -1.4007448029171849502 -1.0419194375691374077 -3.408876824355363766 0.84522561107745197706 1.8743648596547251017];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 3.5417016677858;
y1_step1.xoffset = 0.435275281648062;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = logsig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = logsig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = logsig_apply(repmat(b4,1,Q) + LW4_3*a3);
    
    % Layer 5
    a5 = repmat(b5,1,Q) + LW5_4*a4;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a5,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(5,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
  a = 1 ./ (1 + exp(-n));
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
